"use strict";window.fbAsyncInit=function(){FB.init({appId:window.facebookId,status:!0,cookie:!0,xfbml:!0,version:"v2.4"})},function(e,o,t){var a,c=e.getElementsByTagName(o)[0];e.getElementById(t)||((a=e.createElement(o)).id=t,a.src="//connect.facebook.net/en_US/sdk.js",c.parentNode.insertBefore(a,c))}(document,"script","facebook-jssdk");var disabled=!1,force=!1;window.connect=function(){if(!disabled){disabled=!0;var e=top.spl.b64(String(top.location.href)+"#conectar-facebook"),o=top.spl.base_url+"/tr/tc/"+top.spl.acc+"/"+top.spl.cid+"/"+e;if(top.spl.ajax(o,!1),force)var t={scope:"public_profile, email",auth_type:"rerequest",return_scopes:!0};else t={scope:"public_profile, email",return_scopes:!0};FB.login(function(e){e.authResponse&&String(e.authResponse.grantedScopes).search("email")>-1?FB.api("/me?fields=name,email,gender",function(o){$(".js-facebook--image").attr("src","https://graph.facebook.com/"+o.id+"/picture?type=large"),$(".js-facebook--name").html(o.name),window.connect=!0,$(".js-facebook--home").animate({opacity:"0"},200,function(){$(".js-facebook--home").css("display","none"),$(".js-facebook--thanks").css("display","block").stop().animate({opacity:"1"},120)});try{var t={token:e.authResponse.accessToken},a={name:o.name,gender:o.gender};t=JSON.stringify(t),a=JSON.stringify(a),top.shopback.setMetadata("contact",{type:"facebook",value:o.id,keys:t,details:a,active:!0})}catch(e){console.log("Error when try to save facebook data")}$.ajax({type:"POST",url:"//app.shopconvert.com.br/facebook/callback.php?ref="+String(top.location.href),data:{token:e.authResponse.accessToken,user_id:o.id,user_name:o.name,user_email:o.email,user_gender:o.gender,post:!0},success:function(e){$.post("//app.shopconvert.com.br/tr/tl/"+top.spl.acc+"/"+top.spl.cid,{email:o.email}),top.spl.set_cookie("_spl_overlay_social","disabled",720);try{top._st_app.ci(String(o.email)),top._st_app.set_name(String(o.name))}catch(e){}},error:function(e,o,t){}})}):(disabled=!1,$(".facebook").css("opacity","1"),force||(force=!0,$(".facebook").trigger("click")))},t)}};